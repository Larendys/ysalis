const _0x496c=['MAX_COMPACTION_OPERATIONS','tableName','sort','stopAutocompaction','_compactImmediate','You\x20cannot\x20connect\x20to\x20a\x20DataStore\x20until\x20a\x20game\x20World\x20is\x20active','remove','datastores','NeDBDatastore','delete','skip','MIN_COMPACTION_OPERATIONS','__esModule','insertMany','set','../../common/utils.js','_compactDebounce','exec','findOne','disconnect','loadDatabase','findMany','localeCompare','_onWriteOperation','active','connected','compactDatafile','insert','limit','Compacted\x20database\x20file\x20for\x20','_ops','compareStrings','find','update','connect','persistence','nedb','defineProperty','deleteOne'];(function(_0xa3f7ff,_0x496c13){const _0x37a8ba=function(_0x228265){while(--_0x228265){_0xa3f7ff['push'](_0xa3f7ff['shift']());}};_0x37a8ba(++_0x496c13);}(_0x496c,0x8f));const _0x37a8=function(_0xa3f7ff,_0x496c13){_0xa3f7ff=_0xa3f7ff-0x0;let _0x37a8ba=_0x496c[_0xa3f7ff];return _0x37a8ba;};'use strict';Object[_0x37a8('0xb')](exports,_0x37a8('0x19'),{'value':!![]});exports[_0x37a8('0x15')]=exports[_0x37a8('0x14')]=void 0x0;const Datastore=require(_0x37a8('0xa'));const {debounce}=require(_0x37a8('0x1c'));exports[_0x37a8('0x14')]=new Map();class NeDBDatastore extends Datastore{constructor(_0x395f97,..._0x594ec1){super(..._0x594ec1);this[_0x37a8('0xe')]=_0x395f97;this[_0x37a8('0x26')]=![];this[_0x37a8('0x4')]=0x0;this['_lastWrite']=0x0;this['_compactDebounce']=debounce(()=>this['_compactImmediate'](),0x7d0);}static[_0x37a8('0x8')](_0x9764e2,_0x1351ea){return new Promise((_0x157784,_0x306da6)=>{if(!game[_0x37a8('0x25')])_0x306da6(_0x37a8('0x12'));let _0x3a0f22=new NeDBDatastore(_0x9764e2,{'filename':_0x1351ea,'compareStrings':this[_0x37a8('0x5')]});_0x3a0f22[_0x37a8('0x21')](_0x1e946a=>{if(_0x1e946a)_0x306da6(_0x1e946a);exports['datastores'][_0x37a8('0x1b')](_0x9764e2,_0x3a0f22);_0x3a0f22[_0x37a8('0x26')]=!![];return _0x157784(_0x3a0f22);});});}static[_0x37a8('0x5')](_0x19f7d0,_0x87dc2e){return _0x19f7d0[_0x37a8('0x23')](_0x87dc2e);}[_0x37a8('0x20')](){this['connected']=![];this['persistence'][_0x37a8('0x10')]();this['persistence'][_0x37a8('0x0')]();exports[_0x37a8('0x14')][_0x37a8('0x16')](this['tableName']);}['_compactImmediate'](){if(this[_0x37a8('0x4')]<NeDBDatastore[_0x37a8('0x18')])return;this[_0x37a8('0x4')]=0x0;this[_0x37a8('0x9')][_0x37a8('0x0')]();logger['info'](_0x37a8('0x3')+this['tableName']);}[_0x37a8('0xc')](_0x5f36d8){return new Promise((_0x1328c0,_0x57dde2)=>{this[_0x37a8('0x13')](_0x5f36d8,_0x586fdf=>{if(_0x586fdf)return _0x57dde2(_0x586fdf);_0x1328c0();this['_onWriteOperation']();});});}['deleteMany'](_0x1fcd6e={}){return new Promise((_0x98f26,_0x251a57)=>{this['remove'](_0x1fcd6e,{'multi':!![]},(_0x236e20,_0x5c3668)=>{if(_0x236e20)return _0x251a57(_0x236e20);_0x98f26(_0x5c3668);this[_0x37a8('0x24')]();});});}[_0x37a8('0x22')](_0x35676e,_0x45ce88){_0x45ce88=_0x45ce88||{};return new Promise((_0x488dfe,_0x5be3f7)=>{let _0x274f58=this[_0x37a8('0x6')](_0x35676e);if(_0x37a8('0xf')in _0x45ce88)_0x274f58=_0x274f58['sort'](_0x45ce88[_0x37a8('0xf')]);if(_0x37a8('0x17')in _0x45ce88)_0x274f58=_0x274f58[_0x37a8('0x17')](_0x45ce88['skip']);if('limit'in _0x45ce88)_0x274f58=_0x274f58[_0x37a8('0x2')](_0x45ce88[_0x37a8('0x2')]);_0x274f58[_0x37a8('0x1e')]((_0x18aa42,_0x369099)=>{if(_0x18aa42)return _0x5be3f7(_0x18aa42);return _0x488dfe(_0x369099);});});}[_0x37a8('0x1f')](_0x40660c){return new Promise((_0x22b7c1,_0x33d45f)=>{super[_0x37a8('0x1f')](_0x40660c,(_0x41a9cd,_0xdaeb2d)=>{if(_0x41a9cd)return _0x33d45f(_0x41a9cd);return _0x22b7c1(_0xdaeb2d);});});}['insertOne'](_0x5110a9){return new Promise((_0x3bcaf3,_0x35ce7d)=>{super['insert'](_0x5110a9,(_0x58b608,_0x10f2ae)=>{if(_0x58b608)return _0x35ce7d(_0x58b608);_0x3bcaf3(_0x10f2ae);this[_0x37a8('0x24')]();});});}[_0x37a8('0x1a')](_0x1a9112){return new Promise((_0x432eec,_0x719ac0)=>{super[_0x37a8('0x1')](_0x1a9112,(_0x3b3658,_0xfd146f)=>{if(_0x3b3658)return _0x719ac0(_0x3b3658);_0x432eec(_0xfd146f);this['_onWriteOperation']();});});}['updateOne'](_0x5e06ed,_0x2c94fb){let _0x2a4b60={'upsert':![],'returnUpdatedDocs':!![],'multi':![]};return new Promise((_0x2286f8,_0x54cec2)=>{this[_0x37a8('0x7')](_0x5e06ed,_0x2c94fb,_0x2a4b60,(_0xa076bc,_0x4b074a,_0x1ee8c2)=>{if(_0xa076bc)return _0x54cec2(_0xa076bc);_0x2286f8(_0x1ee8c2);this[_0x37a8('0x24')]();});});}['updateMany'](_0x13ef92,_0x2e0762){let _0x50ec61={'upsert':![],'returnUpdatedDocs':!![],'multi':!![]};return new Promise((_0x387126,_0x3c63ad)=>{this[_0x37a8('0x7')](_0x13ef92,_0x2e0762,_0x50ec61,(_0x3e67a9,_0x2aa9dc,_0x2e6c4d)=>{if(_0x3e67a9)return _0x3c63ad(_0x3e67a9);_0x387126(_0x2e6c4d);this[_0x37a8('0x24')]();});});}[_0x37a8('0x24')](){this[_0x37a8('0x4')]+=0x1;if(this[_0x37a8('0x4')]>=NeDBDatastore[_0x37a8('0xd')]){return this[_0x37a8('0x11')]();}else if(this[_0x37a8('0x4')]>=NeDBDatastore[_0x37a8('0x18')]){return this[_0x37a8('0x1d')]();}}}exports[_0x37a8('0x15')]=NeDBDatastore;NeDBDatastore[_0x37a8('0x18')]=0x32;NeDBDatastore[_0x37a8('0xd')]=0xfa;module['exports']={'NeDBDatastore':NeDBDatastore,'datastores':exports[_0x37a8('0x14')]};